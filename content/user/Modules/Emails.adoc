---
Title: Emails
Weight: 140
---
:experimental:   ////this is here to allow btn:[]syntax used below

:imagesdir: ./../../../images/en/user

:toc:

= Emails

== Introduction

{{% notice note %}}
This documentation is for *SuiteCRM* versions 7.9.x and later. For earlier versions of *SuiteCRM*, please see link:../emails-lts/[Emails-LTS].
{{% /notice %}}

Configuring email for *SuiteCRM* provides a wide range of features, including sending personal emails to contacts, automatic creation of cases, sending notifications for events using link:../advanced-open-workflow/[workflows] and sending email marketing link:../campaigns/[campaigns].

The *Emails* module in *SuiteCRM* allows Users to view, store, compose, send and receive email from their own personal email account or a shared inbox, for example a Support or Sales inbox. 
Emails can be imported and associated with a related *SuiteCRM* record, for example a Contact or an Account. These related emails can then be viewed on the history subpanel of the related record.

=== Changes to the Emails Module

In previous releases, *SuiteCRM* synchronised email headers before the user could view mail. From 7.9. onwards, *SuiteCRM* contacts the emails server directly, retrieving only the minimal information needed to process an operation. This eliminates the synchronisation process and significantly reduces the amount of email information that needs to be stored in the database. 
If you are upgrading from a version of *SuiteCRM* prior to 7.9.x, please see the <<Upgrading, Upgrade guide>> section of this document.

== Email Client Overview

{{% notice note %}}
You will need to set up and have access to at least one *personal* or *group* email account in order to use the *Emails* module. 
{{% /notice %}}

The *Emails* Module can be found on the *All* menu on the top naviagtion bar. The module opens in List View, showing all the the mail from the default mail account inbox in the main window. 

image:250EmailsListView.png[title="Emails Module List View"]

The current inbox name is displayed on the button to the top right-hand side of the list view. Use this button to switch between accounts or other monitored folders.

Unread emails have a purple highlight

[cols="10,90",frame="none", grid="none"]
|===
|image:257EmailsImportedIcon.png[title="Imported mail icon"]|Emails which have been <<Import Mail,imported>> into *SuiteCRM* are indicated by a tick.
|image:258EmailsFlaggedIcon.png[title="Flagged mail icon"]|Emails which have been flagged for follow up are indicated by an exclamation mark.
|===

As in other *SuiteCRM* modules, emails can be sorted by clicking on the column headings. Filter and column selections can also be made in the same way as for other modules.

[frame="none", grid="none"]
|===

|The main actions for the *Emails* module are contained within the buttons on the *Emails* toolbar. Hover over these buttons to see the explanatory tooltip for each function.|image:251EmailsListViewtoolbar.png[title="Emails List View toolbar"]
|===

[cols="10,10,80",frame="none", grid="none"]
|===

|image:253EmailsBulkAction.png[title="Bulk Action button"]|*Bulk Action*|Use the Bulk Action dropdown to bulk <<Import Mail,import mail>>, to mark mail as read/unread or to flag mail for follow up. Multiple emails can be selected in list view using the checkboxes.
|image:252EmailsComposebutton.png[title="Compose Mail button"]|*Compose Mail* |Opens the <<Compose Mail, Compose>> window to create a new message.
|image:254EmailsSettingsButton.png[title="Mail Settings button"]|*Settings*|Shortcut to your user profile where you can edit your <<User Profile Email Settings, mail settings>>.  Add and remove accounts and select folders to view here.
|image:255EmailsCheckForMailButton.png[title="Check for Mail button"]|*Check For Mail*| For personal email accounts, you can check for new mail with this button . Note that for Group email accounts, checking for email is done automatically via the *Check Inbound Mailboxes* Scheduler. You will need to ensure that your cron settings are correct for the scheduler to run. Please see link for further information on Schedulers.
|image:256EmailsChangeFolderButton.png[title="Select Folder button"]|*Select Folder*|This allows you to select which monitored folder you wish to view. If you have more than one account set up, you can also switch between accounts with this button. Expanding an account in the list will show all the monitored folders for the account. Select the required folder.
|===

=== Read Mail

Click on the subject line of an email to open it in Detail view. Use the Actions menu to reply to, forward or <<Import Mail,import>> the email.
image:269EmailsActionMenu.png[title="Action menu"]

=== Compose Mail

Click the btn:[Compose Mail] button or select *Compose* from the *Sidebar* to open a new compose mail window. 

Emails can also be composed directly from a *SuiteCRM* record by clicking the email address on the record. This will open compose view in the *Emails* module. For new emails opened in this way, the *To* field will be automatically populated and the email related to the relevant record. 

If you have opted to use an external email client in your <<User Profile Email Settings, user profile email settings>>, clicking an email address on a record in *SuiteCRM* will open a new email in your chosen editor.

image:260Emailcompose.png[title="Compose Email"]

* *Email Template:* Select a template if required. See <<Email Templates>> for more information on creating email templates. Once you have selected a template, a popup will warn you that the subject line and body of the email will be replaced by the contents of the email template. 
// image:261EmailsAddtemplate.png[title="Adding Email template warning"]

* *Related To:* To associate the email with a particular record, select the module (e.g. Accounts, Contacts, Leads) and then click the Search arrow to search for the record. alternatively, you can begin typing the name into the field and select the contact, lead, account from the list

If you are using a template with variables, these will be populated with the relevant data from the related record when the email is sent. The *To* field will also be automatically populated with the email address associated with the related record.

* *From:* If you have more than one email account configured, select the account from which to send the email. The *Reply To* and *From* settings for the selected account are displayed alongside for information.

* *To:* Selecting a related record in the with a valid email address will automatically populate the *To* field. Alternatively, the *To*, *Cc* and *Bcc* fields can be populated manually or via the select buttons which appear when you click inside the fields.

* *Body:*  If you have configured a signature for each account in your <<User Mail Settings - General Tab, user profile email settings>>, this will appear automatically in the body of the email.

[frame="none", grid="none"]
|===
|The toolbar at the bottom of the Compose view has the following buttons|image:262Emailscomposetoolbar.png[title="Emails - Compose toolbar"]
|===

[cols="10,10,80",frame="none", grid="none"]
|===
|image:263EmailsSendMailbutton.png[title="Send Mail button"]|*Send Mail* |
|image:264EmailsAddFilesbutton.png[title="Add Files button"]|*Attach Files*| Use this button to browse for and attach an *external* file to the email.
|image:265EmailsAddDocumentsbutton.png[title="Add Documents button"]|*Attach Documents*|Use this button to attach a *SuiteCRM Document* to the email. Search for the required Document in the popup and click btn:[Select] to attach it.
|image:266EmailsSaveDraftbutton.png[title="Save Draft button"]|*Save Draft*|Drafts can be viewed by <<Select Folder, changing the folder>> in list view.
|image:267EmailsDiscardbutton.png[title="Discard button"]|*Discard*|Discards the draft email without sending.
|===

=== Import Mail

Email can be imported into *SuiteCRM* and associated with a relevant *SuiteCRM* record (e.g. a contact or account record). This can be very useful in keeping a history of communication with a client, for example.
Emails which have been imported and related to a record in *SuiteCRM* can be viewed from the record's history subpanel.

There are two ways to import email from an *Emails* module inbox:

* from detail view of email record Actions-> Import
* from list view Bulk Action -> Import

On importing, a dialog will open allowing you to select which record to relate the email(s) to. Select the module type from the drop-down and use the search arrow button to find and select the relevant record.

Note that if you are bulk importing mail, all emails will be related to the record selected here.

image:268EmailsImportDialog.png[title="Import emails"]

*SuiteCRM* can also be configured to automatically import emails for group mail accounts. See <<Setting up A Group Email Account, Group Email Accounts>> for more information.

=== Delete Mail
As only imported emails are stored in *SuiteCRM*, only imported email records can be deleted from the *Emails* module. 

To delete an imported email record, open the email and then select Delete from the Actions menu dropdown. Note that this will only delete the SuiteCRM record and not the imap message. To remove emails from the Emails module, you will need to move or delete them using your external mail client.

== Setting Up Mail Accounts

=== Personal Email Account

Setting up a personal email account in *SuiteCRM* allows the user to view personal mail accounts within the *Emails* module. Emails from personal mailboxes are not stored in the *SuiteCRM* database unless manually <<Importing Mail,imported>>. 
Settings for personal email accounts are held within the user's profile. 

{{% notice note %}}
Individual users can set up their own personal accounts. Administrators can set up personal accounts for other users from the user profile in User Management.
{{% /notice %}}

==== User Profile Email Settings
Open the user profile and scroll to the bottom of the main *User Profile tab* to view mail settings.

image:270Emailusersettings.png[User Email Settings]

* *Email Address* - Add the email address(es) for your *SuiteCRM* account. Click btn:[+] to add more addresses. 
* *Email Client* - This setting controls which editor is used to compose and send mail when you click on an email link in SuiteCRM, for example an email address on a contact or account record.
	** *SuiteCRM Email Editor* - The *SuiteCRM* *Emails* module editor will be used
	** *External Email Editor* - With External email editor set, mail links in *SuiteCRM* will open in whichever email client you have set to open `mailto://` links, for example Outlook or Thunderbird

* *Email Editor* - This allows you to set the editor used when creating and editing <<Email Templates, email templates>> and also within the link:../campaigns[Campaigns] module. The *Email Editor* setting does not affect the *SuiteCRM Emails* module *Compose* view, which uses TinyMCE. This setting is not currently user-definable. 


==== Adding A Personal Mail Account
Click the btn:[Settings] button at the bottom of the main User Profile tab to add a personal mail account.


Select the Mail Accounts Tab and click btn:[Add] under Mail Accounts to set up your incoming mail account.
image:271EmailsAddPersonalAccount.png[Mail Accounts tab]

Complete the required details for the account in the dialog which appears. You will need the username and password for the account you are adding, plus the mail server address. The mail protocol supported by *SuiteCRM* is IMAP. You may also need to set the Mail Server Port if this differs from the default IMAP setting. Your system administrator should be able to provide you with these settings. Once entered, verify your mail settings by clicking the btn:[Test Settings] to test the connection to the account. 

image:272EmailsPersonalAccountSettings.png[User Email Settings] 

*Monitored Folders:* are the folders which are checked for new (unread) mail. You must specify an *Inbox* and a *Sent* items folder here. Enter the folder names or click btn:[Select] to connect to the mail server and select the relevant folder(s) from the popup dialog.
image:273EmailsMonitoredFolders.png[Select monitored folders]

*Signatures:* Select a sginature for this account. This will be automatically added to the email body when composing an email using the Emails module. If you wish to crete a new signature, you will need to do this from the <<User Mail Settings - General Tab, General tab>> and then select it here. This will override the default setting on the <<User Mail Settings - General Tab, General tab>>.

Once set up, the account will appear on the *Mail Accounts* tab. If you have more than one account configured you can set the default account to appear when you open the *Emails* module. Accounts set as active will be available to select. 
You can edit personal mail account settings here by clicking the pencil icon.
image:275EmailsAccountList.png[Accounts List]

==== User Mail Settings - General Tab

There are further settings for mail on the *General Tab*:

image:274EmailsGeneralTab.png[User Mail Settings General tab]

* *Check for New Mail* - Here you can specify a time interval to automatically check for new mail in your account's monitored folders. The default setting is to check for mail manually, using the Check Mail button in Emails list view. 

* *Default Signature* - Option to specify the default signature that will be added to the email body when a new email is composed. Click btn:[Create] to add a new one or select one from the list. Existing signatures can be edited and deleted here. 

* *Folder management* -Select the folder(s) which will be available to view from the *Emails* module. This list will show all the monitored folders from all the mail accounts to which you have access. Use ctrl+click to select more than one folder. 

Click btn:[Done] to save your settings. A confirmation dialog will appear. 
You should now be able to <<Email Client Overview,view your emails>> in the *Emails* module.

=== Group Email Account

A group email account allows more than one user to access a particular mail account. This can be useful for sales or support email accounts for example. In addition, group accounts are also used for sending email campaigns and as bounce handling mailboxes for campaigns.

SuiteCRM can also be configured to automatically import emails and to automatically <<Create Case From Email,create cases>> from email.

{{% notice note %}}
You will need to have Administrator access to set up and give access to a group email account.
{{% /notice %}} 

==== Group Mail Settings

Open the *Admin* panel and select *Inbound Mail* from the *Email* section.
Select *New Group Mail Account* from the Sidebar.

You will need the username and password for the account you are adding, plus the mail server address. The mail protocol supported by SuiteCRM is IMAP. 

*Monitored Folders* are the folders which are checked for new (unread) mail. *Inbox* and *Trash* folder names must be specified here. Click btn:[Select] to connect to the mail server and select the relevant folder(s) from the popup dialog.

image:280EmailsGroupMailSettings.png[Group Mail Settings]

==== Email Handling Options

image:281EmailsEmailHandlingOptions.png[Email Handling Options]

===== Import Emails Automatically

Check this box to import emails automatically, which means that records will be created in SuiteCRM for all incoming emails. These associated emails can then be viewed via the History subpanel of the relevant record. 
This setting is selected by default in *SuiteCRM*.

===== Create Case From Email
Check this box to set up SuiteCRM to create a *Case* record from an incoming email. 

image:282EmailsCreateCase2.png[Create Case]

Select a *Distribution Method* to specify how cases created from incoming email are assigned to users.
[cols="20,80",frame="none", grid="none"]
|===
|*Use AOP default*|This will use the settings in link:../advanced-open-cases-with-portal[Advanced Open Portal], configurable via the Admin panel. 
|*Single User*| Enter a username or click the select arrow to search for a user. Every automatically created case will be assigned to the specified user.
|*Round Robin*| Select All Users or an existing security group or role. Cases will be assigned to the next member of the specified group or role
|*Least Busy*| Select All Users or an existing security group or role. Cases will be assigned to the member of the specified group or role with the least case assignments.
|*Random*| Select All Users or an existing security group or role. Cases will be assigned randomly to members of the specified group or role
|===

*New Case Auto-Reply template* 

If *SuiteCRM* has been configured to auto-create cases, you can specify an <<Email Templates,email template>> to use as an automated reponse to notify email senders that a case has been created. If no template is specified here, this automated reponse will not be sent.

image:286EmailsNewCaseAutoReply.png[New Case Auto-Reply template]

[cols="20,80",frame="none", grid="none"]
|===
|No Auto_Reply to this Domain|No auto-reponses will be sent to the specifed domain. Use for example to exclude your company domain, so users do not receive auto-reply messages. 
|Number of Auto-responses|This setting specifies the maximum number of replies to send to a particular email address in a 24hr period.
|===

//image:287EmailsGroupReplyToSettings.png[Group Mail Reply To settings]

[cols="20,80",frame="none", grid="none"]
|===
|*From Name*|
|*From Address*| Used as the from address where supported, otherwise will use <<System Outbound Mail Settings,default system outbound>> mail server account 
|*Reply To Name*|
|*Reply-to Address*|
|*Allow users to send emails using the From name and Address as the reply to address*| When checked, the From Name and From Address for this account will appear as a *From* option when composing an email for all users that have access to this group account.
|===

Once configured, all inbound accounts are listed under *Inbound Accounts* on the *Admin* panel, from where they can be edited or removed. 

=== Bounce Handling Account

When an email cannot be delivered to the intended recipient, it bounces. A Bounce Handling Account is used to manage these responses for an email link:../campaigns[campaign]. Bounced email addresses are recorded in the campaign status.

Open the *Admin* panel and select *Inbound Mail* from the *Email* section.
Select *New Bounce Handling Account* from the Sidebar.

Once created, the bounce handling account can be selected when setting up a link:../campaigns[campaign].

Detail other campaign-specific email settings here? i.e. Campaign Email Settings and Email Queue?

=== System Outbound Mail Settings

The default system outbound mail settings are used to send system notification emails such as password reset emails, record assignment notifications and link:../advanced-open-workflow[workflow] email notifications.

{{%notice note %}}You will need administrator access to set up the system outbound account
{{% /notice %}}

Open the *Admin* panel and select *Email Settings* from the *Email* section. Enter the required configuration information for your system. 
image:290EmailsSettings.png[default system settings]

*Allow users to use this account for outgoing mail*
When this option selected, all users will be able to send emails using this outgoing mail account, which is the same as that used to send system notifications and alerts. If the option is not selected,
users can still use the outgoing mail server after providing their own account information.

Click btn:[SEND TEST EMAIL] to check your settings. You will be asked to enter an email address for the test message to be sent to. A verification message will be displayed if the email was sent successfully. Check that you have received this test message.

Once the settings have been verified, be sure to click btn:[Save] so that these settings are retained.

==== Email Options

[frame = "none", grid = "none"]
|===
|Assignment Notifications| When selected, users will be emailed when a record is assigned to them.
|Send notification from assigning user's email address|Where the mail server supports this, the assigning user's name and email address will be included in the From field of the notification email. Otherwise the default system outbound account will be used.
|===

==== Email Security Settings

== Email Templates

=== Introduction

Email templates are created from the *Email Templates* module which can be opened from the All menu.

image:300EmailsTemplates.png[Email Templates] 

There are a number of default system templates which are created on install. These are used to send out system notifications such as new passwords or case updates. These can be viewed and edited here alongside user-generated templates. Templates created here can also be used in Workflows and Campaigns for example, as well as for system notifications.

Click on a template name to view the template. 

To edit an existing template, either open the template and select Edit from the Actions menu, or click the pencil icon to the left of the template name. Once in Edit mode, the template can be edited in the same way as <<Creating a template, creating a template>>.

=== Creating an Email Template

Select *Create Email Template* from the sidebar. This Create view will also appear if you choose to create a template from within another module such as Workflows, for example. Select Email, Campaign or System depending on the use for the template. System templates are used to send system generated notifications such as case updates.

image:301EmailsNewTemplate.png[New email template]

==== Body

To add text to the body of the template, click, drag and drop one of the layouts from the selection in the left-hand pane into the onto the body. You can add as many layout sections as required. Overwrite the demo text by first highlighting it.

==== Adding Variables
To add a variable, select the appropriate module and field name from the drop-down lists. The corresponding variable name will be displayed in the last field.

image:302EmailsInsertVariable.png[Insert template variable]

You can either enter this variable manually, or click btn:[Add Variable] to insert the variable at the cursor point. Variables can be added to the subject line as well as the body of the email template.

image:303EmailsInsertVariable2.png[Template variable in subject and body]


==== Attachments

[cols="20,80",frame="none", grid="none"]
|===
|image:304EmailsTemplateAttachment.png[Template attachments]|Click btn:[Browse] to attach an external file or btn:[Documents] to attach a *SuiteCRM* document to the template. Further items can be attached in the same way. The attached file(s) will be sent to all recipients of the template.
|===

==== Security Groups

Restrict access to a template by selecting a Security Group. 

== Upgrading
If you are upgrading from a version of SuiteCRM prior to *7.9.x*, you will need to use the *Sync Inbound Email Account Tool* on upgrading. This tool will synchronise mail already imported into SuiteCRM with your current IMAP accounts so that you will not have to synchronise in the future.

The Sync Inbound Email Accounts tool goes through all the selected inbound email accounts and updates them to support new features in SuiteCRM 7.9 onwards:

* Connects to the email server (via IMAP)
* Downloads the email header information
* Determines the orphaned status of emails
* Updates the unique ID for each email
* Corrects synchronisation problems

When running the tool, you will see the progression of each process. When an error occurs, you can run the tool on the other accounts which are working. The details of each error can be found in the suitecrm.log file.

